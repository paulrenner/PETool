# Fix List — 2026-01-29

Generated from Phase 7 synthesis of recurring code review.

**Status:** No critical or high-priority fixes required. Codebase is in good health.

---

## Summary of Previous Fixes (All Complete)

All items from fix-list-2026-01-22 have been completed:
- ✅ FIX-001: Timezone date parsing in IRR
- ✅ FIX-002: Timezone edge case test
- ✅ FIX-003: Golden dataset validation test
- ✅ FIX-004: Pre-validation pass for import
- ✅ FIX-010: Remove unsafe Date() fallback
- ✅ FIX-011: Document distribution commitment behavior
- ✅ FIX-020: Split modals.ts into smaller modules

---

## Short-term (Medium Priority)

### FIX-030: Add logging for currency parse failures
- **File:** `src/calculations/metrics.ts`
- **Lines:** 35, 56, 67, 96, 107, 119, 139, 165
- **Category:** correctness
- **Problem:** `parseCurrency(...) || 0` silently converts parse failures to zero, potentially hiding data issues.
- **Fix:** Add warning when parseCurrency returns null on non-empty input:
  ```typescript
  function safeParseCurrency(value: any, context: string): number {
    const result = parseCurrency(value);
    if (result === null && value != null && value !== '') {
      console.warn(`Currency parse failed (${context}):`, value);
    }
    return result || 0;
  }
  ```
- **Verification:** Import fund with malformed amount — should warn in console.

---

### FIX-031: Unify date parsing in metrics.ts
- **File:** `src/calculations/metrics.ts`
- **Lines:** 13, 33, 50-51, 62-63, 86-87, 102, 135, 150-151, 158
- **Category:** consistency
- **Problem:** While IRR uses `parseDateLocal()`, metrics.ts uses raw `new Date()` for comparisons. Though ordering is correct (both dates shift equally), consistency would improve maintainability.
- **Fix:** Extract a shared `parseDate()` utility from irr.ts and use throughout metrics.ts.
- **Verification:** Run `npm test` — all tests should pass.

---

## Long-term (Low Priority)

### FIX-040: Add import rollback behavior test
- **File:** `__tests__/import.test.js` (new or existing)
- **Category:** test-gap
- **Coverage:** Verify that invalid funds abort entire import, no partial data committed.
- **Priority:** low

### FIX-041: Add TVPI ≈ MOIC assertion test
- **File:** `__tests__/calculations.test.js`
- **Category:** test-gap
- **Coverage:** Verify TVPI and MOIC produce consistent results for various funds.
- **Priority:** low

---

## Completion Tracking

| ID | Status | Completed | Commit | Notes |
|----|--------|-----------|--------|-------|
| FIX-030 | Pending | — | — | — |
| FIX-031 | Pending | — | — | — |
| FIX-040 | Pending | — | — | — |
| FIX-041 | Pending | — | — | — |
